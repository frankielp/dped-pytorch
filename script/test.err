Lmod Warning: The environment MODULEPATH has been changed in unexpected ways.
Lmod is unable to use given MODULEPATH. It is using:

"/sw/spack/share/spack/modules/linux-ubuntu20.04-skylake:/sw/modules/all".

Please use "module use ..." to change MODULEPATH instead. 


  0%|          | 0/10 [00:00<?, ?it/s] 40%|████      | 4/10 [00:00<00:00, 35.19it/s] 90%|█████████ | 9/10 [00:00<00:00, 43.08it/s]100%|██████████| 10/10 [00:00<00:00, 41.61it/s]
  0%|          | 0/4353 [00:00<?, ?it/s]  0%|          | 7/4353 [00:00<01:03, 68.46it/s]  0%|          | 14/4353 [00:00<01:15, 57.43it/s]  0%|          | 21/4353 [00:00<01:10, 61.62it/s]  1%|          | 28/4353 [00:00<01:15, 57.12it/s]  1%|          | 38/4353 [00:00<01:05, 66.16it/s]  1%|          | 45/4353 [00:00<01:07, 63.93it/s]  1%|▏         | 57/4353 [00:00<00:54, 78.50it/s]  2%|▏         | 66/4353 [00:00<00:52, 81.41it/s]  2%|▏         | 76/4353 [00:01<00:49, 86.04it/s]  2%|▏         | 90/4353 [00:01<00:43, 98.25it/s]  2%|▏         | 100/4353 [00:01<00:44, 95.45it/s]  3%|▎         | 110/4353 [00:01<00:45, 92.41it/s]  3%|▎         | 121/4353 [00:01<00:44, 94.93it/s]  3%|▎         | 131/4353 [00:01<00:46, 90.16it/s]  3%|▎         | 141/4353 [00:01<00:48, 87.17it/s]  3%|▎         | 150/4353 [00:01<00:49, 84.97it/s]  4%|▎         | 159/4353 [00:01<00:53, 79.12it/s]  4%|▍         | 167/4353 [00:02<00:55, 75.93it/s]  4%|▍         | 177/4353 [00:02<00:51, 81.88it/s]  4%|▍         | 188/4353 [00:02<00:47, 88.12it/s]  5%|▍         | 199/4353 [00:02<00:44, 93.17it/s]  5%|▍         | 211/4353 [00:02<00:41, 98.82it/s]  5%|▌         | 221/4353 [00:02<00:43, 94.24it/s]  5%|▌         | 233/4353 [00:02<00:41, 98.45it/s]  6%|▌         | 243/4353 [00:02<00:42, 97.09it/s]  6%|▌         | 253/4353 [00:02<00:46, 88.23it/s]  6%|▌         | 266/4353 [00:03<00:42, 95.78it/s]  6%|▋         | 282/4353 [00:03<00:36, 110.08it/s]  7%|▋         | 302/4353 [00:03<00:30, 133.73it/s]  7%|▋         | 316/4353 [00:03<00:31, 127.50it/s]  8%|▊         | 330/4353 [00:03<00:31, 126.06it/s]  8%|▊         | 343/4353 [00:03<00:35, 113.18it/s]  8%|▊         | 355/4353 [00:03<00:37, 107.51it/s]  8%|▊         | 366/4353 [00:03<00:38, 104.85it/s]  9%|▊         | 377/4353 [00:04<00:39, 101.55it/s]  9%|▉         | 388/4353 [00:04<00:40, 98.54it/s]   9%|▉         | 400/4353 [00:04<00:38, 102.79it/s]  9%|▉         | 413/4353 [00:04<00:35, 109.87it/s] 10%|▉         | 425/4353 [00:04<00:38, 101.83it/s] 10%|█         | 436/4353 [00:04<00:39, 97.93it/s]  11%|█         | 458/4353 [00:04<00:30, 129.55it/s] 11%|█         | 482/4353 [00:04<00:24, 157.38it/s] 12%|█▏        | 511/4353 [00:04<00:19, 192.26it/s] 12%|█▏        | 540/4353 [00:05<00:17, 217.86it/s] 13%|█▎        | 563/4353 [00:05<00:17, 216.49it/s] 13%|█▎        | 586/4353 [00:05<00:17, 212.38it/s] 14%|█▍        | 610/4353 [00:05<00:17, 217.36it/s] 15%|█▍        | 642/4353 [00:05<00:15, 245.84it/s] 15%|█▌        | 669/4353 [00:05<00:14, 250.24it/s] 16%|█▌        | 696/4353 [00:05<00:14, 255.90it/s] 17%|█▋        | 722/4353 [00:05<00:14, 242.96it/s] 17%|█▋        | 751/4353 [00:05<00:14, 255.16it/s] 18%|█▊        | 781/4353 [00:06<00:13, 258.95it/s] 19%|█▊        | 808/4353 [00:06<00:14, 245.84it/s] 19%|█▉        | 845/4353 [00:06<00:12, 279.92it/s] 20%|██        | 874/4353 [00:06<00:13, 260.50it/s] 21%|██        | 901/4353 [00:06<00:14, 230.71it/s] 21%|██        | 925/4353 [00:06<00:15, 222.32it/s] 22%|██▏       | 948/4353 [00:06<00:15, 221.79it/s] 22%|██▏       | 974/4353 [00:06<00:14, 230.96it/s] 23%|██▎       | 998/4353 [00:06<00:16, 209.63it/s] 23%|██▎       | 1020/4353 [00:07<00:18, 177.82it/s] 24%|██▍       | 1042/4353 [00:07<00:17, 187.68it/s] 24%|██▍       | 1062/4353 [00:07<00:17, 184.86it/s] 25%|██▍       | 1082/4353 [00:07<00:17, 188.73it/s] 25%|██▌       | 1105/4353 [00:07<00:16, 194.59it/s] 26%|██▌       | 1125/4353 [00:07<00:17, 184.92it/s] 26%|██▋       | 1147/4353 [00:07<00:16, 192.54it/s] 27%|██▋       | 1167/4353 [00:07<00:17, 185.09it/s] 27%|██▋       | 1186/4353 [00:08<00:17, 182.47it/s] 28%|██▊       | 1212/4353 [00:08<00:15, 201.30it/s] 28%|██▊       | 1233/4353 [00:08<00:16, 187.11it/s] 29%|██▉       | 1264/4353 [00:08<00:14, 219.94it/s] 30%|██▉       | 1287/4353 [00:08<00:14, 217.98it/s] 30%|███       | 1310/4353 [00:08<00:14, 205.55it/s] 31%|███       | 1331/4353 [00:08<00:15, 194.04it/s] 31%|███       | 1360/4353 [00:08<00:13, 219.53it/s] 32%|███▏      | 1385/4353 [00:08<00:13, 222.16it/s] 32%|███▏      | 1408/4353 [00:09<00:14, 206.77it/s] 33%|███▎      | 1430/4353 [00:09<00:15, 194.53it/s] 33%|███▎      | 1450/4353 [00:09<00:14, 195.55it/s] 34%|███▍      | 1471/4353 [00:09<00:14, 198.69it/s] 34%|███▍      | 1496/4353 [00:09<00:13, 210.51it/s] 35%|███▍      | 1518/4353 [00:09<00:13, 205.00it/s] 35%|███▌      | 1544/4353 [00:09<00:12, 219.98it/s] 36%|███▌      | 1572/4353 [00:09<00:11, 234.05it/s] 37%|███▋      | 1610/4353 [00:09<00:10, 271.65it/s] 38%|███▊      | 1638/4353 [00:10<00:10, 255.31it/s] 38%|███▊      | 1666/4353 [00:10<00:10, 260.84it/s] 39%|███▉      | 1693/4353 [00:10<00:10, 246.37it/s] 39%|███▉      | 1718/4353 [00:10<00:10, 243.31it/s] 40%|████      | 1747/4353 [00:10<00:10, 254.60it/s] 41%|████      | 1773/4353 [00:10<00:10, 253.43it/s] 41%|████▏     | 1802/4353 [00:10<00:09, 262.99it/s] 42%|████▏     | 1829/4353 [00:10<00:09, 257.50it/s] 43%|████▎     | 1860/4353 [00:10<00:09, 269.13it/s] 43%|████▎     | 1893/4353 [00:11<00:08, 285.01it/s] 44%|████▍     | 1926/4353 [00:11<00:08, 297.27it/s] 45%|████▌     | 1959/4353 [00:11<00:07, 306.56it/s] 46%|████▌     | 1991/4353 [00:11<00:07, 310.32it/s] 46%|████▋     | 2023/4353 [00:11<00:09, 256.34it/s] 47%|████▋     | 2051/4353 [00:11<00:09, 244.31it/s] 48%|████▊     | 2080/4353 [00:11<00:08, 255.90it/s] 48%|████▊     | 2107/4353 [00:11<00:09, 230.02it/s] 49%|████▉     | 2132/4353 [00:12<00:10, 217.64it/s] 50%|████▉     | 2155/4353 [00:12<00:10, 214.81it/s] 50%|█████     | 2178/4353 [00:12<00:10, 201.64it/s] 51%|█████     | 2199/4353 [00:12<00:10, 199.69it/s] 51%|█████     | 2226/4353 [00:12<00:09, 217.96it/s] 52%|█████▏    | 2252/4353 [00:12<00:09, 229.41it/s] 52%|█████▏    | 2279/4353 [00:12<00:08, 239.26it/s] 53%|█████▎    | 2305/4353 [00:12<00:08, 234.91it/s] 54%|█████▎    | 2329/4353 [00:12<00:08, 232.91it/s] 54%|█████▍    | 2354/4353 [00:12<00:08, 237.37it/s] 55%|█████▍    | 2386/4353 [00:13<00:07, 249.74it/s] 55%|█████▌    | 2412/4353 [00:13<00:07, 249.28it/s] 56%|█████▌    | 2438/4353 [00:13<00:07, 247.10it/s] 57%|█████▋    | 2463/4353 [00:13<00:07, 243.29it/s] 57%|█████▋    | 2488/4353 [00:13<00:08, 223.74it/s] 58%|█████▊    | 2522/4353 [00:13<00:07, 251.38it/s] 59%|█████▊    | 2551/4353 [00:13<00:06, 261.29it/s] 59%|█████▉    | 2578/4353 [00:13<00:06, 254.67it/s] 60%|█████▉    | 2604/4353 [00:13<00:07, 246.08it/s] 61%|██████    | 2642/4353 [00:14<00:06, 282.39it/s] 61%|██████▏   | 2674/4353 [00:14<00:05, 291.57it/s] 62%|██████▏   | 2704/4353 [00:14<00:05, 276.41it/s] 63%|██████▎   | 2741/4353 [00:14<00:05, 301.12it/s] 64%|██████▍   | 2777/4353 [00:14<00:04, 315.84it/s] 65%|██████▍   | 2809/4353 [00:14<00:05, 302.42it/s] 65%|██████▌   | 2840/4353 [00:14<00:05, 290.36it/s] 66%|██████▌   | 2871/4353 [00:14<00:05, 293.55it/s] 67%|██████▋   | 2908/4353 [00:14<00:04, 313.24it/s] 68%|██████▊   | 2940/4353 [00:15<00:04, 310.79it/s] 68%|██████▊   | 2972/4353 [00:15<00:04, 302.53it/s] 69%|██████▉   | 3003/4353 [00:15<00:04, 302.56it/s] 70%|██████▉   | 3034/4353 [00:15<00:04, 299.29it/s] 70%|███████   | 3065/4353 [00:15<00:04, 289.93it/s] 71%|███████   | 3095/4353 [00:15<00:04, 264.80it/s] 72%|███████▏  | 3128/4353 [00:15<00:04, 282.14it/s] 73%|███████▎  | 3157/4353 [00:15<00:04, 272.92it/s] 73%|███████▎  | 3191/4353 [00:15<00:04, 289.98it/s] 74%|███████▍  | 3221/4353 [00:16<00:04, 271.25it/s] 75%|███████▍  | 3250/4353 [00:16<00:04, 274.99it/s] 75%|███████▌  | 3278/4353 [00:16<00:03, 272.04it/s] 76%|███████▌  | 3306/4353 [00:16<00:03, 266.58it/s] 77%|███████▋  | 3338/4353 [00:16<00:03, 280.33it/s] 77%|███████▋  | 3367/4353 [00:16<00:03, 280.44it/s] 78%|███████▊  | 3400/4353 [00:16<00:03, 292.55it/s] 79%|███████▉  | 3430/4353 [00:16<00:03, 283.87it/s] 79%|███████▉  | 3459/4353 [00:16<00:03, 268.86it/s] 80%|████████  | 3489/4353 [00:17<00:03, 277.13it/s] 81%|████████  | 3523/4353 [00:17<00:02, 292.76it/s] 82%|████████▏ | 3554/4353 [00:17<00:02, 296.63it/s] 82%|████████▏ | 3587/4353 [00:17<00:02, 296.20it/s] 83%|████████▎ | 3617/4353 [00:17<00:02, 289.28it/s] 84%|████████▍ | 3647/4353 [00:17<00:02, 291.53it/s] 84%|████████▍ | 3677/4353 [00:17<00:02, 263.64it/s] 85%|████████▌ | 3704/4353 [00:17<00:02, 228.16it/s] 86%|████████▌ | 3728/4353 [00:17<00:02, 210.86it/s] 86%|████████▌ | 3750/4353 [00:18<00:02, 211.28it/s] 87%|████████▋ | 3772/4353 [00:18<00:02, 202.90it/s] 87%|████████▋ | 3793/4353 [00:18<00:02, 195.88it/s] 88%|████████▊ | 3819/4353 [00:18<00:02, 211.15it/s] 88%|████████▊ | 3845/4353 [00:18<00:02, 218.35it/s] 89%|████████▉ | 3868/4353 [00:18<00:02, 218.30it/s] 89%|████████▉ | 3895/4353 [00:18<00:02, 223.88it/s] 90%|█████████ | 3921/4353 [00:18<00:01, 232.04it/s] 91%|█████████ | 3945/4353 [00:19<00:01, 210.71it/s] 91%|█████████ | 3967/4353 [00:19<00:01, 207.06it/s] 92%|█████████▏| 3988/4353 [00:19<00:01, 202.28it/s] 92%|█████████▏| 4015/4353 [00:19<00:01, 219.32it/s] 93%|█████████▎| 4038/4353 [00:19<00:01, 214.84it/s] 93%|█████████▎| 4060/4353 [00:19<00:01, 215.34it/s] 94%|█████████▍| 4086/4353 [00:19<00:01, 217.33it/s] 94%|█████████▍| 4108/4353 [00:19<00:01, 188.50it/s] 95%|█████████▍| 4130/4353 [00:19<00:01, 195.33it/s] 96%|█████████▌| 4160/4353 [00:20<00:00, 221.98it/s] 96%|█████████▋| 4190/4353 [00:20<00:00, 241.93it/s] 97%|█████████▋| 4222/4353 [00:20<00:00, 263.59it/s] 98%|█████████▊| 4257/4353 [00:20<00:00, 287.20it/s] 99%|█████████▊| 4288/4353 [00:20<00:00, 293.16it/s] 99%|█████████▉| 4318/4353 [00:20<00:00, 289.51it/s]100%|█████████▉| 4348/4353 [00:20<00:00, 287.28it/s]100%|██████████| 4353/4353 [00:20<00:00, 210.58it/s]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:12<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 390, in <module>
    run(**param)
  File "train.py", line 167, in run
    enhanced_blur = preprocess.blur(enhanced)
  File "/home/lpnquynh/desktop/dped-pytorch/utils/preprocess.py", line 77, in blur
    return gaussian_filter(x)
  File "/home/lpnquynh/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lpnquynh/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/lpnquynh/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument weight in method wrapper_CUDA___conv_depthwise2d)
